<div>
  <div class="panel panel-info">
    <div class="panel-heading">
      <h4 class="panel-title">Import IronGrudge</h4>
    </div>
    <div class="panel-body">
      <form ng-submit="doReadText('ig', import_text)">
        <div class="form-group">
          <label>Choose an IronGrudge CSV file :</label>
          <input class="form-control"
                 id="import-ig-file"
                 type="file"
                 ea-file="doReadFile('ig', file)" />
        </div>
        <div class="text-warning"
             ng-repeat="e in read_result.ig">
          {{::e}}
        </div>
      </form>
      <p>Iron Grudge CSV files are generated by exporting the SQLite backup file from IrongGrudge.</p>
      <p>
        You can use the SQLite Manager firefox plugin to perform this operation.
        The SQL query you need to use in order to generate the correct CSV file is :
      </p>
      <a ng-hide="_show_sql"
         ng-click="_show_sql=true">Click to show SQL query...</a>
      <code ng-show="_show_sql">
          SELECT battle.date, my_faction.name, my_caster.shortname, player.name, opp_faction.name, opp_caster.shortname, battle.result, battle.controlPoints, battle.armyPoints, battle.killPoints, battle.opponentControlPoints, battle.opponentArmyPoints, battle.opponentKillPoints, scenario.name, battle.points, event.name, battle.initiative, battle.comment
          FROM battle
          LEFT JOIN army my_army ON battle.armyId=my_army._id
          LEFT JOIN faction my_faction ON my_army.factionId=my_faction._id
          LEFT JOIN caster my_caster ON my_army.casterId=my_caster._id
          LEFT JOIN player ON battle.opponentId=player._id
          LEFT JOIN army opp_army ON battle.opponentArmyId=opp_army._id
          LEFT JOIN faction opp_faction ON opp_army.factionId=opp_faction._id
          LEFT JOIN caster opp_caster ON opp_army.casterId=opp_caster._id
          LEFT JOIN scenario ON battle.scenarioId=scenario._id
          LEFT JOIN event ON battle.eventId=event._id;
      </code>
    </div>
  </div>
</div>
